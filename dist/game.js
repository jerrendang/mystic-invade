(()=>{"use strict";class e{constructor(e){this.maxspeed=5,this.speedY=5,this.width=5,this.height=5,this.player=e,this.position={x:this.player.position.x+this.player.width/2,y:this.player.position.y}}}class t{constructor(e){this.health=4,this.tempx=Math.floor(Math.random()*e),this.tempx>e-this.width&&(tempx=e-this.width),this.position={x:this.tempx,y:0},this.height=30,this.width=30,this.speedY=2}}const i=document.getElementById("game-screen").getContext("2d"),s=document.getElementById("side_screen").getContext("2d");let o=new class{constructor(e,t){this.width=30,this.height=30,this.gameWidth=e,this.gameHeight=t,this.position={x:e/2-this.width/2,y:t-this.height-10},this.maxSpeed=5,this.Xspeed=0,this.Yspeed=0,this.lives=3,this.score=0}draw_lives(e){for(let t=0;t<this.lives;t+=1)e.fillRect(0,100*t,50,50)}draw(e){e.beginPath(),e.moveTo(this.position.x+this.width/2,this.position.y),e.lineTo(this.position.x+this.width,this.position.y+this.height),e.lineTo(this.position.x,this.position.y+this.height),e.stroke(),e.fillStyle="black",e.fill()}update(e){e&&(this.position.x+=this.Xspeed,this.position.y+=this.Yspeed,this.position.x<=0&&(this.position.x=0),this.position.x>=this.gameWidth-this.width&&(this.position.x=this.gameWidth-this.width),this.position.y<=0&&(this.position.y=0),this.position.y>=this.gameHeight-this.height&&(this.position.y=this.gameHeight-this.height))}moveLeft(){this.Xspeed=-this.maxSpeed}moveUp(){this.Yspeed=-this.maxSpeed}moveRight(){this.Xspeed=this.maxSpeed}moveDown(){this.Yspeed=this.maxSpeed}stopX(){this.Xspeed=0}stopY(){this.Yspeed=0}}(450,720),h=new class{projectiles=[];timerTillNextProjectile=0;constructor(e){this.player=e}draw(e,t){if(t.position.y<=0){let e=this.projectiles.indexOf(t);this.projectiles.splice(e,1)}else e.fillStyle="black",e.fillRect(t.position.x-t.width/2,t.position.y,t.width,t.height)}update(e,t){e&&(t.position.y-=t.maxspeed)}shoot(){this.timerTillNextProjectile<=0&&this.projectiles.push(new e(this.player))}}(o),l=new class{constructor(e,t){this.enemies=[],this.GAME_HEIGHT=t,this.GAME_WIDTH=e,this.default_delay=90,this.spawn_delay=90}draw(e,t,i){if(t.position.y>=this.GAME_HEIGHT){let e=this.enemies.indexOf(t);this.enemies.splice(e,1),i.lives-=1}else{switch(t.health){case 4:e.fillStyle="green";break;case 3:e.fillStyle="yellow";break;case 2:e.fillStyle="orange";break;case 1:e.fillStyle="red"}e.fillRect(t.position.x,t.position.y,t.width,t.height)}}update(e,t){e&&(t.position.y+=t.speedY)}spawn(){0==this.spawn_delay&&(this.enemies.push(new t(this.GAME_WIDTH)),this.spawn_delay=this.default_delay),this.spawn_delay-=1}}(450,720),n=new class{constructor(e,t){this.projectile_controller=e,this.enemy_controller=t}enemy_projectile_collision(e){this.projectile_controller.projectiles.forEach((t=>{this.enemy_controller.enemies.forEach((i=>{if(t.position.y<=i.position.y+i.height&&t.position.x+t.width>=i.position.x&&t.position.x<=i.position.x+i.width){let s=this.projectile_controller.projectiles.indexOf(t),o=this.enemy_controller.enemies.indexOf(i);1==i.health?(e.score+=100,this.projectile_controller.projectiles.splice(s,1),this.enemy_controller.enemies.splice(o,1)):(i.health-=1,this.projectile_controller.projectiles.splice(s,1))}}))}))}}(h,l);o.draw(i);let p=0;new class{constructor(e,t){document.addEventListener("keydown",(i=>{switch(i.keyCode){case 37:case 65:e.moveLeft();break;case 38:case 87:e.moveUp();break;case 39:case 68:e.moveRight();break;case 40:case 83:e.moveDown();break;case 80:case 32:t.shoot()}})),document.addEventListener("keyup",(t=>{switch(t.keyCode){case 37:case 65:e.Xspeed<0&&e.stopX();break;case 38:case 87:e.Yspeed<0&&e.stopY();break;case 39:case 68:e.Xspeed>0&&e.stopX();break;case 40:case 83:e.Yspeed>0&&e.stopY()}})),document.addEventListener("keydown",(e=>{if(80===e.keyCode)return!0}))}}(o,h),function e(t){let a=t-p;p=t,0!=o.lives&&(i.clearRect(0,0,450,720),s.clearRect(0,0,100,400),s.fillText(o.score,0,300),o.update(a),o.draw(i),o.draw_lives(s),l.spawn(),l.enemies.forEach((e=>{l.draw(i,e,o),l.update(a,e)})),h.projectiles.forEach((e=>{h.draw(i,e),h.update(a,e)})),n.enemy_projectile_collision(o),requestAnimationFrame(e))}()})();